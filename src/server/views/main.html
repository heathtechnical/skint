<!DOCTYPE html>
<html lang="en" ng-app="skApp">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
        <meta charset="utf-8">
        <title>Skint Money Tracker</title>
        <meta name="generator" content="Bootply" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
        
        <!--[if lt IE 9]>
          <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-cookies.min.js"></script>
        <script src="public/js/skint/skint-controllers.js"></script>
    </head>
    <body ng-controller="skMoneyTracker">
        <div class="container">
    <div class="container"></div>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Money Tracker</a>
    </div>
  </div><!-- /.container-fluid -->
</nav>

    <div id="accountPane" class="row">
        <div class="col-md-9">
            <h2>{[{account.name}]}</h2>
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                                <h3 class="panel-title">This Month</h3>

                        </div>
                        <div class="panel-body">
                            <!--<img src="http://placehold.it/1000x300" class="img-responsive center-block">-->
                            <div style="width:100%; height:250px;" sk-account-chart></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                          <h3 class="panel-title">Payments
                            <button class="btn btn-success btn-xs pull-right" sk-add-payment-popover>
                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add
                            </button>
                          </h3>
                        </div>
                        <div class="panel-body" style="max-height: 380px; overflow-y: scroll; min-height: 380px">
                            <div role="tabpanel">
                                <ul class="nav nav-tabs" role="tablist">
                                    <li role="presentation" class="active"><a href="#accountsPaymentsTabScheduled" aria-controls="scheduled" role="tab" data-toggle="tab">Scheduled</a></li>
                                    <li role="presentation"><a href="#accountsPaymentsTabAdHoc" aria-controls="adhoc" role="tab" data-toggle="tab">Ad-Hoc</a></li>
                                </ul>
                                <div class="tab-content">
                                    <div role="tabpanel" class="tab-pane active" id="accountsPaymentsTabScheduled">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th class="" width="25%">Day</th>
                                                    <th class="" width="35%">Description</th>
                                                    <th class="" width="15%">Amount</th>
                                                    <th class=""></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="payment in account.payments | filter: {type: 'scheduled'} | orderBy:'last_modified'" ng-class="payment.editMode ? 'info' : payment.isRemaining ? 'danger' : ''">
                                                    <td>
                                                        <span ng-hide="payment.editMode">{[{payment.fuzzy}]}</span>
                                                        <div class="input-group input-group-sm" ng-show="payment.editMode">
                                                            <input type="text" class="form-control" ng-model="payment.day">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <span ng-hide="payment.editMode">{[{payment.description}]}</span>
                                                        <div class="input-group input-group-sm" ng-show="payment.editMode">
                                                            <input type="text" class="form-control" ng-model="payment.description">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <span ng-hide="payment.editMode">{[{payment.amount | number:2}]}</span>
                                                        <div class="input-group input-group-sm" ng-show="payment.editMode">
                                                            <input type="text" class="form-control" ng-model="payment.amount">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="btn-group btn-group-xs pull-right">
                                                            <button class="btn btn-xs" ng-class="payment.editMode ? 'btn-success' : 'btn-primary'" ng-click="payment.editMode ? saveEditPayment(payment) : editPayment(payment)">
                                                                <span class="glyphicon" ng-class="payment.editMode ? 'glyphicon-ok' : 'glyphicon-pencil'"></span>
                                                            </button>
                                                            <button class="btn btn-xs btn-danger" ng-click="deletePayment(payment)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div role="tabpanel" class="tab-pane" id="accountsPaymentsTabAdHoc">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th class="" width="60%">Description</th>
                                                    <th class="" width="15%">Amount</th>
                                                    <th class=""></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="payment in account.payments | filter: { type: 'adhoc' }"  ng-class="payment.editMode ? 'info' : ''">
                                                    <td>
                                                        <span ng-hide="payment.editMode">{[{payment.description}]}</span>
                                                        <div class="input-group input-group-sm" ng-show="payment.editMode">
                                                            <input type="text" class="form-control" ng-model="payment.description">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <span ng-hide="payment.editMode">{[{payment.amount | number:2}]}</span>
                                                        <div class="input-group input-group-sm" ng-show="payment.editMode">
                                                            <input type="text" class="form-control" ng-model="payment.amount">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="btn-group btn-group-xs pull-right">
                                                            <button class="btn btn-xs" ng-class="payment.editMode ? 'btn-success' : 'btn-primary'" ng-click="payment.editMode ? saveEditPayment(payment) : editPayment(payment)">
                                                                <span class="glyphicon" ng-class="payment.editMode ? 'glyphicon-ok' : 'glyphicon-pencil'"></span>
                                                            </button>
                                                            <button class="btn btn-xs btn-danger" ng-click="deletePayment(payment)">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                                <h3 class="panel-title">Quick Stats</h3>
                        </div>
                        <div class="panel-body" style="min-height: 380px">
                        <table class="table table-striped">
                            <tr>
                                <th>Payment Cycle</th>
                                <td colspan="2">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-addon" id="sizing-addon3">Day</span>
                                        <input type="text" class="form-control" ng-model="paymentCycleDay">
                                        <span class="input-group-btn">
                                            <button class="btn btn-primary" type="button" ng-click="updatePaymentCycleDay(paymentCycleDay)">Update</button>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th width="55%">Current Balance</th>
                                <td colspan="2">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-addon" id="sizing-addon3">£</span>
                                        <input type="text" class="form-control" ng-model="currentBalance">
                                         <span class="input-group-btn">
                                            <button class="btn btn-primary" type="button" ng-click="updateCurrentBalance(currentBalance)">Update</button>
                                         </span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th>Remaining Scheduled</th>
                                <td><div>£{[{account.quickstats.remaining_scheduled_payments[0] | number:2}]}</div></td>
                                <td><div>£{[{account.quickstats.remaining_scheduled_payments[1] | number:2}]}</div></td>
                            </tr>
                            <tr>
                                <th>Remaining Ad-Hoc</th>
                                <td><div>£{[{account.quickstats.remaining_adhoc_payments[0] | number:2}]}</div></td>
                                <td><div>£{[{account.quickstats.remaining_adhoc_payments[1] | number:2}]}</div></td>
                            </tr>
                            <tr>
                                <th>Estimated Closing Balance</th>
                                <td colspan="2"><div>£{[{account.quickstats.estimated_closing_balance | number:2}]}</div></td>
                            </tr>
                        </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <h2>My Accounts</h2>
            <div class="list-group">
                <a ng-repeat="account in accountList" ng-class="accountID == account['_id'] ? 'active' : ''" href="#" class="list-group-item" ng-click="switchAccount(account['_id'])">
                    <span class="badge">£{[{account.current_balance | number:2}]}</span>{[{account.name}]}
                </a>

                <a href="#" class="list-group-item list-group-item-success" style="text-align: center" sk-add-account-popover>
                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>Add Account
                </a>
            </div>
	    </div>
    </div>
</div>

        <script type="text/ng-template" id="addAccountPopover.html">
        <div class="form-group">
            <label>Amount</label>
            <input type="text" class="form-control" placeholder="Account name" ng-model="newAccount.name">
        </div>
        <button class="btn btn-primary btn-block" ng-click="addAccountButton(newAccount)">Add</button>
        </script>

        <script type="text/ng-template" id="addPaymentPopover.html">
        <div class="form-group">
            <label for="accountPaymentsScheduledAddType">Payment Type</label>
            <div class="row">
                <div class="col-xs-6">
                    <div class="radio">
                        <label>
                            <input type="radio" name="optionsRadios" value="scheduled" checked ng-model="newPayment.type">
                            Scheduled
                        </label>
                    </div>
                </div>
                <div class="col-xs-6">
                    <div class="radio">
                        <label>
                            <input type="radio" name="optionsRadios" value="adhoc" ng-model="newPayment.type">
                            Ad-Hoc
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-group has-feedback" style="margin-bottom: 0px">
                <label for="accountPaymentsAddDescription">Description</label>
                <input type="text" class="form-control" placeholder="Payment description" ng-model="newPayment.description">
                <span class="glyphicon glyphicon-remove form-control-feedback" style="display: none"></span>
                <span id="inputError2Status" class="sr-only" style="display: none">(error)</span>
                <span  class="help-block" style="display: none; margin-bottom: 0px">Duplicate payment description.</span>
            </div>

            <label for="accountPaymentsAddAmount">Amount</label>
            <input type="text" class="form-control accountPaymentsAddAmount" placeholder="Payment amount" ng-model="newPayment.amount">

            <div ng-hide="newPayment.type == 'adhoc'">
                <label for="accountPaymentsAddDay">Day</label>
                <input type="text" class="form-control" placeholder="Payment day" ng-model="newPayment.day">
                <span class="help-block accountPaymentsAddDayHelp" style="display: none">Should be a number</span>
            </div>
        </div>
        <button class="btn btn-primary btn-block" ng-click="addPaymentButton(newPayment)">Add</button>
        </script>

        <script type='text/javascript' src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
        <script type='text/javascript' src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
    </body>
</html>
